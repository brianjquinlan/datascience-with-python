{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        
        <title> {% block title %} ML with Python {% endblock %} </title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="blog/information site on machine learning">
        <meta name="author" content="Brian Quinlan">
        
        {% block css %}
        	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

			<!-- third party css -->
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:400,300,500,600,700">
            <link href="{% static 'css/hilite.css' %}" rel="stylesheet">
            
			<!-- site specific css -->
			<link href="{% static 'css/style.css' %}" rel="stylesheet">

		{% endblock %}

		{% block scripts %}
            <script src="https://use.fontawesome.com/48fcfe07d5.js"></script>
		{% endblock %}
    </head>
    <body>

		{% block nav %}
            <nav class="navbar navbar-toggleable-sm menu">
    			<button class="navbar-toggler navbar-toggler-right"
					type="button" data-toggle="collapse" data-target="#navbar">
        				<span class="navbar-toggler-icon"> &#9776; </span>
    			</button>
    			
				<a class="navbar-brand brand" href="{% url 'home' %}">DataScience with Python</a>
    			<div class="navbar-collapse collapse justify-content-end" id="navbar">
        			<ul class="navbar-nav float-sm-right links">
						<li class="nav-item">
						    <a class="nav-link" href="{% url 'home' %}"> Home</a>
						</li>
						<li class="nav-item">
						    <a class="nav-link" href="#"> About </a>
						</li>
						<li class="nav-item">
						    <a class="nav-link" href="{% url 'blog:post_list' %}"> Blog </a>
						</li>
        			</ul>
  			    </div>
			</nav>
		{% endblock %}

		{% if messages %}
			{% for message in messages %}
				<div class="alert {% if message.tags %} alert-{{ message.tags }}{% endif %}">
					{{ message }}
				</div>
			{% endfor %}
		{% endif %}
        
        <div class="container-fluid" id="main">
            <div class="row">
			    {% block content %}
					    <p> content </p>
			    {% endblock content	%}
		    </div>
        </div>

		{% block footer %}
		{% endblock %}

	 	{% block javascript %}
			<!-- jQuery -->
			<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
			<!-- requirement for bootstrap -->
     	 	<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.2.0/js/tether.min.js"></script>
			
			<!-- Javascript -->
			<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

			<!-- project javascript -->
			<script src="{% static 'js/project.js' %}"></script>
		    
            <!-- js-plugin to get csrftoken  -->
            <script src="{% static 'js/js.cookie.js' %}"></script>

            <script>
                //(function() {
                    var csrftoken = Cookies.get('csrftoken');
                    function csrfSafeMethod(method) {
                        // these HTTP methods do not requre CSRF protection
                        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
                    }
                    $.ajaxSetup({
                        beforeSend: function(xhr, settings) {
                            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                                xhr.setRequestHeader("X-CSRFToken", csrftoken);
                            }
                        }
                    });
                //})();

                $(document).ready(function(){
                    $('#subscribe').submit(function(e) {
                        e.preventDefault();
                        var email_id = $('#email_id').val();

                        if (email_id) {
                            var csrfmiddlewaretoken = csrftoken;
                            var email_data = {'email_id': email_id,
                                'csrfmiddlewaretoken': csrfmiddlewaretoken };
                            
                            $.ajax({
                                type: 'POST',
                                url: '/blog/subscribe/',
                                dataType: 'json',
                                data: email_data,
                                success: function(response) {
                                    $('#email_id').val('');

                                    if (response.status_code == '400') {
                                        alert("This email is already part of this list");

                                    } else {
                                        alert("Thank you for subscribing Check your email to confirm.");
                                    }
                                },
                                error: function(response) {
                                    alert("Something went wrong");
                                    $('#email_id').val('');
                                }
                            });
                            return false;
                        } else {
                            alert('Please provide correct email');
                        }
                    });

                    {% block domready %} 
                    {% endblock %}
                });
            </script>
            
        {% endblock %}
        
    </body>
</html>
